<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="Tushar's personal blog"><title>PyAutoGUI | Tushar | Blog</title><link rel="stylesheet" type="text/css" href="/blog//css/normalize.css"><link rel="stylesheet" type="text/css" href="/blog//css/highlight.css"><link rel="stylesheet" type="text/css" href="/blog//css/very-simple.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="Shortcut Icon" type="image/x-icon" href="/blog/favicon.ico"><link rel="alternate" type="application/atom+xml" href="/blog/atom.xml"></head><body><!-- include the sidebar--><!-- include ./includes/sidebar.jade--><!-- Blog title and subtitle--><header><div class="container header"><a id="logo" href="/blog/." class="title">Tushar | Blog</a><span class="subtitle"></span><label id="toggle-menu" for="menu" onclick><i class="fa fa-bars"></i></label></div></header><!-- use checkbox hack for toggle nav-bar on small screens--><input id="menu" type="checkbox"><!-- Navigation Links--><nav id="nav"><div class="container"><a href="/blog/" class="sidebar-nav-item">Home</a><a href="/blog/archives" class="sidebar-nav-item">Archives</a></div></nav><div id="header-margin-bar"></div><!-- gallery that comes before the header--><div class="wrapper"><div class="container post-header"><h1>PyAutoGUI</h1></div></div><div class="wrapper"><div class="container meta"><div class="post-time">2016-05-23</div><div class="post-tags"><a class="post-tag-link" href="/blog/tags/GUI-Automation/">GUI Automation</a>/<a class="post-tag-link" href="/blog/tags/Python/">Python</a></div></div></div><article><div class="container post"><p>Recently, I came across <a href="https://github.com/asweigart/pyautogui" target="_blank" rel="external">PyAutoGUI</a>, a cross platform <strong>G</strong>raphical <strong>U</strong>ser <strong>I</strong>nterface automation Python module. The module allows us to programmatically control the mouse and keyboard. That means we can write scripts to automate the tasks that involved mouse movements/clicks or inputs from keyboard. To understand better let’s write a simple script that would draw a <a href="https://en.wikipedia.org/wiki/Peace_symbols" target="_blank" rel="external">Symbol of Peace</a> for us. If you don’t have any paint tool then you may try online for free at <a href="http://www.sumopaint.com/" target="_blank" rel="external">SumoPaint</a>.</p>
<p>So before our script executes, we will have Brush tool selected. We could handle the selection of brush tool but it all depends on the position of the brush tool in Paint and it differs for various Paint softwares.<br>So let’s get started.</p>
<p>Importing required modules. Nothing cool here.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> pyautogui</span><br><span class="line"><span class="keyword">import</span> time</span><br></pre></td></tr></table></figure>

<p> Ideally, we would want to have control over our automation script even in situations when things go wrong. We could ask script to wait after every function call, giving us a short window to take control of the mouse and keyboard if something goes wrong.<br> This pause after each function call can be implemented by setting a certain numeric value to <strong>PAUSE</strong> constant in <strong>pyautogui</strong> module.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pyautogui.PAUSE = <span class="number">1</span>    <span class="comment"># Pause for 1 seconds after every function call</span></span><br></pre></td></tr></table></figure>

<p>We may also want to add an initial delay to let user select an appropriate paint tool.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">time.sleep(<span class="number">5</span>)</span><br></pre></td></tr></table></figure>

<p>Screen size can be obtained using <code>size</code> method. If you observer carefully, <code>Symbol of Peace</code> is a big circle enclosing an inverted <code>Y</code>. Circular path can be traced using <a href="https://en.wikipedia.org/wiki/Parametric_equation" target="_blank" rel="external">parametric equation</a>. Let us assume screen center as circle center.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cx, cy = pyautogui.size()    <span class="comment"># center for circle</span></span><br><span class="line">cx /= <span class="number">2</span></span><br><span class="line">cy /= <span class="number">2</span></span><br><span class="line">radius = <span class="number">100</span>    <span class="comment"># Radius of circle</span></span><br><span class="line">angle = <span class="number">0</span>        <span class="comment"># Frame of reference for revolution.</span></span><br><span class="line">omega = <span class="number">0.3</span>        <span class="comment"># Angular velocity</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># parametric equation of a circle</span></span><br><span class="line">x = cx + radius <em> math.cos(angle)</em></span><br><span class="line">y = cy + radius  math.sin(angle)</span><br></pre></td></tr></table></figure>

<p>Mouse clicks can be implemented using <strong>pyautogui.click</strong> method. A mouse click is a combination of the two events:</p>
<ul>
<li>Pressing the button.</li>
<li>Releasing the button.</li>
</ul>
<p>Both combined makes one click. <em>pyautogui.click</em> takes <strong>x</strong> and <strong>y</strong> coordinates of the region to click upon. If these params are not passed then a click is performed at the current mouse position.</p>
<p>Let’s implement mouse click to focus on the paint region.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pyautogui.click(x,y)</span><br></pre></td></tr></table></figure>

<p>Apart from a click, we can also drag mouse cursor. <em>PyAutoGUI</em> provides the <strong>pyautogui.dragTo()</strong> and <strong>pyautogui.dragRel()</strong> functions to drag the mouse cursor to a new location or a location relative to its current one. <em>dragTo</em> takes <em>x</em> and <em>y</em> coordinate of the final position and <em>dragRel</em> takes <em>x</em> and <em>y</em> coordinates and interprets it relative to the current position.<br>The origin lies at top-left corner of screen and the x-coordinates increase going to the right, and the y-coordinates increase going down. All coordinates are positive integers; there are no negative coordinates.</p>
<p>Now next few lines would create a circular path with enclosed inverted <code>Y</code>. The idea is to use parametric equation of circle and keep incrementing the angle until one complete revolution or 2*PI angle has been swept.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="number">2</span><em>math.pi - angle &gt;= <span class="number">0.001</span>:</em></span><br><span class="line">    angle = angle + omega</span><br><span class="line">    x = x + radius  omega <em> math.cos(angle + math.pi / <span class="number">2</span>)</em></span><br><span class="line">    y = y + radius  omega <em> math.sin(angle + math.pi / <span class="number">2</span>)</em></span><br><span class="line">    pyautogui.dragTo(x, y, duration=<span class="number">0.2</span>)</span><br><span class="line"></span><br><span class="line">pyautogui.moveTo(cx, cy-radius, duration=<span class="number">0.2</span>)</span><br><span class="line">pyautogui.dragTo(cx, cy+radius, duration=<span class="number">0.2</span>)</span><br><span class="line">pyautogui.moveTo(cx, cy, duration=<span class="number">0.2</span>)</span><br><span class="line">pyautogui.dragTo(cx - radius  math.cos(math.pi/<span class="number">4</span>), cy + radius <em> math.sin(math.pi/<span class="number">4</span>), duration=<span class="number">0.2</span>)</em></span><br><span class="line">pyautogui.moveTo(cx, cy, duration=<span class="number">0.2</span>)</span><br><span class="line">pyautogui.dragTo(cx + radius  math.cos(math.pi/<span class="number">4</span>), cy + radius * math.sin(math.pi/<span class="number">4</span>), duration=<span class="number">0.2</span>)</span><br></pre></td></tr></table></figure>

<p>Combining all together</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> pyautogui</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">time.sleep(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">cx, cy = pyautogui.size()</span><br><span class="line">cx /= <span class="number">2</span></span><br><span class="line">cy /= <span class="number">2</span></span><br><span class="line">radius = <span class="number">100</span></span><br><span class="line">angle = <span class="number">0</span></span><br><span class="line">omega = <span class="number">0.3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># parametric equation of circle</span></span><br><span class="line">x = cx + radius <em> math.cos(angle)</em></span><br><span class="line">y = cy + radius  math.sin(angle)</span><br><span class="line">pyautogui.click(x,y)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="number">2</span><em>math.pi - angle &gt;= <span class="number">0.001</span>:</em></span><br><span class="line">    angle = angle + omega</span><br><span class="line">    x = x + radius  omega <em> math.cos(angle + math.pi / <span class="number">2</span>)</em></span><br><span class="line">    y = y + radius  omega <em> math.sin(angle + math.pi / <span class="number">2</span>)</em></span><br><span class="line">    pyautogui.dragTo(x, y, duration=<span class="number">0.2</span>)</span><br><span class="line"></span><br><span class="line">pyautogui.moveTo(cx, cy-radius, duration=<span class="number">0.2</span>)</span><br><span class="line">pyautogui.dragTo(cx, cy+radius, duration=<span class="number">0.2</span>)</span><br><span class="line">pyautogui.moveTo(cx, cy, duration=<span class="number">0.2</span>)</span><br><span class="line">pyautogui.dragTo(cx - radius  math.cos(math.pi/<span class="number">4</span>), cy + radius <em> math.sin(math.pi/<span class="number">4</span>), duration=<span class="number">0.2</span>)</em></span><br><span class="line">pyautogui.moveTo(cx, cy, duration=<span class="number">0.2</span>)</span><br><span class="line">pyautogui.dragTo(cx + radius  math.cos(math.pi/<span class="number">4</span>), cy + radius * math.sin(math.pi/<span class="number">4</span>), duration=<span class="number">0.2</span>)</span><br></pre></td></tr></table></figure>

<p>You may try and run this script after selecting a brush tool.<br>Here is a Demo<br><img src="http://res.cloudinary.com/tusharrishav/image/upload/c_scale,w_640/v1464026198/demo_gsvgit.gif" alt="Demo"></p>
<p>Please note that this was only a brief introduction to GUI automation using Python. <strong>PyAutoGUI</strong> also provides a bunch of other functions like to perform hotkeys operations (<em>Ctrl + c</em> for copy) etc.<br>If you find this module interesting you should check out its <a href="http://pyautogui.readthedocs.io/en/latest/introduction.html" target="_blank" rel="external">documentation.</a></p>
<p>Cheers!</p>
</div><!-- comment system--><div class="container"><hr><div id="disqus_thread"></div><script type="text/javascript">
var disqus_shortname = 'gtushar';
var disqus_identifier = '2016/05/23/PyAutoGUI/';
var disqus_title = 'PyAutoGUI';
var disqus_url = 'http://gtushar.co/blog/blog/2016/05/23/PyAutoGUI/';
(function() {
   var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
   dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
   (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">Blog comments powered by <span class="logo-disqus">Disqus</span></a></div></article><footer id="footer"><div class="container"><div class="bar"><div class="social"><a href="mailto:tushar.rishav@gmail.com" target="_blank"><i class="fa fa-envelope-o"></i></a><a href="http://twitter.com/tushar_rishav" target="_blank"><i class="fa fa-twitter"></i></a><a href="https://github.com/tushar-rishav" target="_blank"><i class="fa fa-github"></i></a><a href="/blog/atom.xml" target="_blank"><i class="fa fa-rss"></i></a></div><div class="footer">© 2016 <a href="/" rel="nofollow">Tushar | Blog</a>. Powered by <a rel="nofollow" target="_blank" href="https://hexo.io">Hexo</a>. Theme <a target="_blank" href="https://github.com/lotabout/very-simple">very-simple</a>.</div></div></div></footer><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
    $(".fancybox").fancybox();
});
</script></body><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
e=o.createElement(i);r=o.getElementsByTagName(i)[0];
e.src='//www.google-analytics.com/analytics.js';
r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
ga('create','UA-77419685-1');ga('send','pageview');</script></html>